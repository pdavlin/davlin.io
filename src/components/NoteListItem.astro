---
const { slug, title, added, type, rating, includeDate = true, basePath = '/blog' } = Astro.props;

const addedSegments = added.split(' ')[0].split('-');
const day = addedSegments[2];

function formatStars(rating: number): string {
  if (!rating) return '';
  const fullStars = Math.floor(rating);
  const hasHalf = rating % 1 >= 0.5;
  return 'â˜…'.repeat(fullStars) + (hasHalf ? 'Â½' : '');
}

const stars = type === 'film' && rating ? formatStars(rating) : '';
---

<style>
  li {
    margin-bottom: 0.5em;
    display: flex;
  }

  .date {
    margin-right: 0.5em;
    font-family: var(--font-mono);
    font-weight: 600;
    font-size: 0.92em;
    line-height: 1.6em;
    color: var(--color-text);
    text-shadow: 2px 2px 0 var(--color-date-shadow);
  }

  li a {
    text-decoration: none;
    line-height: 1.36;
    color: currentColor;
  }

  li a:hover {
    text-decoration: underline;
  }

  :global(li a.book::before) {
    content: 'ðŸ“˜ ';
    text-decoration: none;
  }

  :global(li a.film::before) {
    content: 'ðŸŽ¬ ';
    text-decoration: none;
  }

  .rating {
    color: var(--accent-color);
    font-size: 0.85em;
    margin-left: 0.25em;
    white-space: nowrap;
  }
</style>

<li class="note">
  {includeDate && <span class="date">{day}</span>}
  <a class={type} href={`${basePath}/${slug}/`}>
    {title}
    {stars && <span class="rating">{stars}</span>}
  </a>
</li>
